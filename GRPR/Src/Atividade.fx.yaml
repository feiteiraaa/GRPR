Atividade As screen:
    OnVisible: |
        =Concurrent(
            Reset(InputPesquisar),
            Refresh(Atividades)
        );
        
        ClearCollect(CollectAtividades, Atividades);

    Label1_9 As label:
        FontWeight: =FontWeight.Bold
        Height: =48
        Size: =15
        Text: ="Atividade"
        Width: =409
        X: =364
        Y: =41
        ZIndex: =3

    AtividadeTable As dataTable.datatable:
        BorderStyle: =BorderStyle.Solid
        DisplayMode: =DisplayMode.Edit
        Fill: =RGBA(0, 0, 0, 0)
        HeadingFill: =cores.cinzento
        Height: |
            =472
        Items: |-
            =    SortByColumns(
                    Filter (
            
                        CollectAtividades, 
                        If(!IsBlank(InputPesquisar.Text), InputPesquisar.Text in ThisRecord.Titulo, true)
                        And
                        If(!IsBlank(DatePicker2.SelectedDate),
                ThisRecord.Data >= DatePicker1.SelectedDate 
                Or 
                ThisRecord.Data<=DatePicker2.SelectedDate  , true)
            
                
                ),"uipp_data",varSortDir
                )
        SelectedFill: =cores.amareloMontepio
        Width: =980
        X: =357
        Y: =200
        ZIndex: =4

        "'Criado Por_Column1' As dataTableColumn.complexTypeColumn":
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Criado Por"
            FieldName: ="createdby"
            FieldVariantName: ="complexTypeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            OnSelect: |-
                =UpdateContext({ShowDetails: true})
            Order: =9
            Text: =ThisItem.'Criado Por'.'Nome Completo'
            Width: =100
            X: =656
            Y: =0
            ZIndex: =3

        Atividade_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Atividade"
            FieldName: ="uipp_atividadeid"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            OnSelect: |-
                =UpdateContext({ShowDetails: true})
            Order: =5
            Text: =ThisItem.Titulo
            Width: =100
            X: =0
            Y: =0
            ZIndex: =6

        Data_Column1 As dataTableColumn.dateTimeColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Data"
            FieldName: ="uipp_data"
            FieldVariantName: ="dateTimeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            OnSelect: |-
                =UpdateContext({ShowDetails: true})
            Order: =7
            Text: |-
                =Text(DateTimeValue(ThisItem.Data), "dd/mm/yyyy hh:mm")
            Width: =222
            X: =0
            Y: =0
            ZIndex: =7

        uipp_tipodealteracao_Column1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Tipo de Alteração"
            FieldName: ="uipp_tipodealteracao"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =8
            Text: =ThisItem.uipp_tipodealteracao
            Width: =161
            X: =368
            Y: =0
            ZIndex: =8

    LeftSectionComponent_11 As LeftSectionComponent:
        ZIndex: =15

    Group7 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =25

        TopSectionComponent_2 As TopSectionComponent:
            X: =313
            Y: =29
            ZIndex: =2

        BtnExportar As DynamicBtn:
            BtnOnSelect: =
            BtnText: ="Exportar"
            ButtonIcon: =Icon.Download
            Height: =41
            Width: =160
            X: =1185
            Y: |
                =130
            ZIndex: =5

        InputPesquisar As text:
            BorderColor: =ColorFade(cores.cinzento, 80%)
            BorderThickness: =1
            Clear: =true
            Color: |-
                =//RGBA(0, 0, 0, 1)
                cores.cinzento
            Default: =
            Fill: =ColorFade(cores.cinzento, 90%)
            HintText: ="Pesquisar"
            HoverBorderColor: =RGBA(128, 128, 128, 1)
            HoverFill: =
            PaddingLeft: =40
            Tooltip: =
            Width: =327
            X: =364
            Y: |
                =130
            ZIndex: =6

        "Icon1_3 As icon.'3DPrinting'":
            Color: |-
                =///RGBA(0, 18, 107, 1)
                cores.amareloMontepio
            Height: =34
            Icon: =Icon.Search
            OnSelect: =//Select(Parent)
            Width: =26
            X: =375
            Y: =135
            ZIndex: =7

        Button2_26 As button:
            BorderColor: =RGBA(0,0,0, 0)
            Color: =RGBA(0,0,0, 0)
            DisabledBorderColor: =RGBA(0,0,0, 0)
            DisabledColor: =RGBA(0,0,0, 0)
            DisabledFill: =RGBA(0,0,0, 0)
            Fill: =RGBA(0,0,0, 0)
            Height: =BtnExportar.Height
            HoverColor: =RGBA(0,0,0, 0)
            HoverFill: =RGBA(0,0,0, 0)
            OnSelect: |-
                =Navigate(ParticipadasDetails, ScreenTransition.None, {ColabFormMode: FormMode.New})
            PressedColor: =RGBA(0,0,0, 0)
            PressedFill: =RGBA(0,0,0, 0)
            Text: =""
            Width: =BtnExportar.Width
            X: =BtnExportar.X
            Y: =BtnExportar.Y
            ZIndex: =8

        DatePicker1 As datepicker:
            BorderColor: =ColorFade(cores.cinzento, 80%)
            BorderThickness: |
                =1
            Fill: =ColorFade(cores.cinzento, 90%)
            Format: |-
                ="dd/mm/yyyy hh:mm"
            IconBackground: =cores.amareloMontepio
            PaddingTop: =5
            Width: =150
            X: =705
            Y: =130
            ZIndex: =9

        DatePicker2 As datepicker:
            BorderColor: =ColorFade(cores.cinzento, 80%)
            BorderThickness: |
                =1
            Fill: =ColorFade(cores.cinzento, 90%)
            Format: |-
                ="dd/mm/yyyy hh:mm"
            Height: |
                =40
            IconBackground: =cores.amareloMontepio
            PaddingTop: =5
            Width: =141
            X: =904
            Y: =130
            ZIndex: =10

        Label11 As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            PaddingBottom: =
            PaddingRight: =
            PaddingTop: =
            Text: ="Datas"
            X: =705
            Y: =100
            ZIndex: =11

        Label11_1 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =47
            PaddingBottom: =
            PaddingTop: =
            Text: ="a"
            Width: =49
            X: =855
            Y: |
                =130
            ZIndex: =12

        Icon1 As icon.Filter:
            Color: =cores.amareloMontepio
            Fill: =ColorFade(cores.cinzento, 90%)
            Height: =40
            Icon: =Icon.Filter
            OnSelect: =Navigate(SearchAtividade,ScreenTransition.None)
            PaddingBottom: =8
            PaddingLeft: =8
            PaddingRight: =8
            PaddingTop: =8
            Width: =45
            X: =1088
            Y: =130
            ZIndex: =14

    PopUp As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =31

        Rectangle2 As rectangle:
            Fill: =RGBA(77, 77, 77, 0.27)
            Height: =768
            Visible: =ShowDetails
            Width: =1366
            ZIndex: =15

        RectDetails As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =384
            Visible: =ShowDetails
            Width: =1014
            X: =176
            Y: =191
            ZIndex: =16

        Button4 As button:
            Fill: =cores.amareloMontepio
            OnSelect: |-
                =UpdateContext({ShowDetails:false})
            Text: ="Fechar"
            Visible: =ShowDetails
            X: =561
            Y: =510
            ZIndex: =18

        Label18 As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Size: =14
            Text: =AtividadeTable.Selected.Titulo
            Visible: =ShowDetails
            Width: =843
            X: =342
            Y: =200
            ZIndex: =19

        Label19 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Fill: =cores.amareloMontepio
            FontWeight: =FontWeight.Semibold
            Size: =14
            Text: |-
                ="Atividade: "
            Visible: =ShowDetails
            Width: =154
            X: =188
            Y: =200
            ZIndex: =20

        Label18_1 As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Text: =AtividadeTable.Selected.'Criado Por'.'Nome Completo'
            Visible: =ShowDetails
            Width: =349
            X: =342
            Y: =252
            ZIndex: =21

        Label19_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Fill: =cores.amareloMontepio
            FontWeight: =FontWeight.Semibold
            Size: =12
            Text: |-
                ="Criado Por: "
            Visible: =ShowDetails
            Width: =154
            X: =188
            Y: =252
            ZIndex: =22

        Label18_2 As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Text: |-
                =Text(DateTimeValue(AtividadeTable.Selected.Data), "dd/mm/yyyy hh:mm")
            Visible: =ShowDetails
            Width: =349
            X: =836
            Y: =252
            ZIndex: =23

        Label19_2 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Fill: =cores.amareloMontepio
            FontWeight: =FontWeight.Semibold
            Size: =12
            Text: |-
                ="Data: "
            Visible: =ShowDetails
            Width: =154
            X: =682
            Y: =252
            ZIndex: =24

        Label18_3 As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Text: =AtividadeTable.Selected.'Tipo de alteracao'
            Visible: =ShowDetails
            Width: =349
            X: =342
            Y: =299
            ZIndex: =25

        Label19_3 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Fill: =cores.amareloMontepio
            FontWeight: =FontWeight.Semibold
            Size: =12
            Text: |-
                ="Tipo de alteração: "
            Visible: =ShowDetails
            Width: =154
            X: =188
            Y: =299
            ZIndex: =26

        Label18_4 As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Text: =AtividadeTable.Selected.'Lista da atividade'
            Visible: =ShowDetails
            Width: =349
            X: =836
            Y: =299
            ZIndex: =27

        Label19_4 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Fill: =cores.amareloMontepio
            FontWeight: =FontWeight.Semibold
            Size: =12
            Text: |-
                ="Lista da Atividade: "
            Visible: =ShowDetails
            Width: =154
            X: =682
            Y: =299
            ZIndex: =28

        Label18_5 As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Height: =127
            Text: |-
                =Substitute(Substitute(Concat(ForAll(Split(
                            AtividadeTable.Selected.Item,
                            Char(34)
                        ), ThisRecord.Value),  ThisRecord.Value, " "), "[", ""), "]","")
                
                
                //AtividadeTable.Selected.Item
                
                
                /*If(
                    ("[" & Char(34)) in AtividadeTable.Selected.Item,
                    Last(FirstN(
                        ForAll(Split(
                            AtividadeTable.Selected.Item,
                            Char(34)
                        ), {Result: ThisRecord.Value})
                    , 2)).Result)*/
                
                
                
                /*If(
                    ("[" & Char(34)) in AtividadeTable.Selected.Item,
                    Last(FirstN(
                        ForAll(Split(
                            AtividadeTable.Selected.Item,
                            Char(34)
                        ), {Result: ThisRecord.Value})
                    , 2)).Result,
                    (Char(34) & "," & Char(34)) in AtividadeTable.Selected.Item,
                    Last(FirstN(
                        ForAll(Split(
                            AtividadeTable.Selected.Item,
                            Char(34)
                        ), {Result: ThisRecord.Value})
                        ,4)).Result,
                
                    (Char(34) & "]") = AtividadeTable.Selected.Item,
                    " ",
                   AtividadeTable.Selected.Item
                    
                    
                     ) */
                
                /*If(
                    ("[" & Char(34)) in AtividadeTable.Selected.Item,
                    First(
                        ForAll(Split(
                            AtividadeTable.Selected.Item,
                            Char(34)
                        ), {Result: ThisRecord.Value})
                    ).Result,
                    (Char(34) & "," & Char(34)) in AtividadeTable.Selected.Item,
                    Last(
                        ForAll(Split(
                            AtividadeTable.Selected.Item,
                            Char(34)
                        ), {Result: ThisRecord.Value})
                    ).Result,
                    (Char(34) & "]") = AtividadeTable.Selected.Item,
                    " ",
                   AtividadeTable.Selected.Item
                    
                )*/
            VerticalAlign: =VerticalAlign.Top
            Visible: =ShowDetails
            Width: =793
            X: =344
            Y: =355
            ZIndex: =29

        Label19_5 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Fill: =cores.amareloMontepio
            FontWeight: =FontWeight.Semibold
            Size: =12
            Text: |-
                ="Alterações:"
            Visible: =ShowDetails
            Width: =154
            X: =188
            Y: =355
            ZIndex: =30

